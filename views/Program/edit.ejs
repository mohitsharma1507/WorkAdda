<%- layout("/layouts/boilerplate") %>
<link rel="stylesheet" href="/css/index.css" />
<link rel="stylesheet" href="/css/edit.css" />

<div class="container edit-notes-container">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="card shadow-sm">
        <div class="card-header bg-primary text-white">
          <h3 class="mb-0">Edit Note</h3>
        </div>

        <div class="card-body">
          <form
            method="POST"
            action="/Program/<%= program._id %>?_method=PUT"
            enctype="multipart/form-data"
            class="needs-validation"
            novalidate
          >
            <div class="row mb-3">
              <div class="col-12">
                <label for="title" class="form-label">Title</label>
                <input
                  name="Program[title]"
                  value="<%= program.title %>"
                  type="text"
                  class="form-control"
                  required
                  placeholder="Enter note title"
                />
                <div class="invalid-feedback">Please provide a valid title</div>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-12">
                <label for="description" class="form-label">Description</label>
                <textarea
                  name="Program[description]"
                  class="form-control"
                  rows="4"
                  required
                  placeholder="Provide a detailed description"
                >
<%= program.description %></textarea
                >
                <div class="invalid-feedback">Please provide a description</div>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-12">
                <label class="form-label">Current Image</label>
                <div class="image-preview text-center">
                  <img
                    src="<%= originalImageUrl %>"
                    class="img-fluid rounded"
                    alt="Current Image"
                    style="max-height: 250px"
                  />
                </div>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-12">
                <label for="image" class="form-label">Upload New Image</label>
                <input
                  name="Program[image]"
                  type="file"
                  class="form-control"
                  accept="image/*"
                />
                <small class="form-text text-muted">
                  Choose a new image to replace the current one (optional)
                </small>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-12">
                <label for="drive-link" class="form-label">Drive Link</label>
                <input
                  id="drive-link"
                  type="text"
                  name="Program[link]"
                  value="<%= program.pdf.link %>"
                  class="form-control"
                  required
                  placeholder="Paste Google Drive share link"
                />
                <div class="invalid-feedback">
                  Please provide a valid drive link
                </div>
                <small class="form-text text-muted">
                  Ensure the link is publicly accessible
                </small>
              </div>
            </div>

            <div class="row">
              <div class="col-12">
                <button type="submit" class="btn btn-primary w-100">
                  Update Note
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  (function () {
    "use strict";
    window.addEventListener(
      "load",
      function () {
        var forms = document.getElementsByClassName("needs-validation");
        var validation = Array.prototype.filter.call(forms, function (form) {
          form.addEventListener(
            "submit",
            function (event) {
              if (form.checkValidity() === false) {
                event.preventDefault();
                event.stopPropagation();
              }
              form.classList.add("was-validated");
            },
            false
          );
        });
      },
      false
    );
  })();
</script>
